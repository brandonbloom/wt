[env]
_.path = "{{ cwd }}/bin"
GOCACHE = "{{ cwd }}/.gocache"
GOMODCACHE = "{{ cwd }}/.gopath"
GOBIN = "{{ cwd }}/bin"

[tools]
go = "latest"
"go:github.com/deref/transcript" = "latest"

[tasks.build]
run = "go build -o bin/ . ./internal/wtcmdtest ./internal/wtghstub"

[tasks.test]
depends = ["build"]
env = { WT_CMDTEST_TIMEOUT = "10s" }
run = "go test ./..."

[tasks.transcripts]
depends = ["build"]
env = { WT_CMDTEST_TIMEOUT = "10s" }
run = "go test -count=1 -run TestTranscripts ./..."
